#srun --nodes=4 --tasks-per-node=4  python ./run_bfd.py --config ./config/config_measure_target_moments_only.yaml --output_label _run1
run:
     - measure_moments_targets
     #- target_noise_tiers

######################################################################
#                       general config
######################################################################

general:
    output_folder:  '/pscratch/sd/m/mgatti/BFD/_test_bfd_y6kp_0.65_fiducial_2_' #'/pscratch/sd/m/mgatti/BFD/_test_bfd_y6kp_0.65_debug_SN/'
    
    # BFD window function parameters. Defaults: n = 4, sigma = 0.65
    filter_sigma: 0.65
    
    # per-band weights.
    bands_meds_files: ['g','r','i','z']
    bands_weights: [0.,0.6,0.3,0.1]

    # pad factor for the FFT of the images. Default: 2. 
    FFT_pad_factor: 2.
    
    # whether if you want to use MPI or not.
    MPI: False

        
######################################################################
#                       measure_moments_targets
######################################################################

measure_moments_targets:
    flagged_exp_list: '/global/homes/m/mgatti/fresh_BFD/BFD_pipeline/data/PSF_cuts.npy'
    reserved_stars_list: '/global/homes/m/mgatti/fresh_BFD/BFD_pipeline/data/coadd_id_reserved_stars_c.npy.npz'
    efficiency_list: '/global/homes/m/mgatti/fresh_BFD/BFD_pipeline/data/zero_point_efficiency.npy'
    debug: False
    debug_SN : False
    compute_shotnoise: True
    max_frac_stamp_masked: 0.05
    chunk_size: 650
    agents: 1
    
    path_MEDS: '/pscratch/sd/m/mgatti/BFD/data/'
    path_galaxy_models: '/pscratch/sd/m/mgatti/BFD/models/'
    tiles: ['DES0009-6248']
    #tiles: ['DES0018-4414','DES0014-3123','DES0030-2332','DES0024-5040','DES0017+0126','DES0005-0041','DES0021-5622','DES0016+0043','DES0017-0333','DES0015-4957','DES0027-5457','DES0027-5705','DES0023+0418','DES0024-4706','DES0014-4249','DES0007-0624','DES0008-5457','DES0016-4706','DES0003+0418','DES0029-3332','DES0017+0209','DES0021-3832','DES0008+0126','DES0014-4914','DES0030-3249','DES0012-0541','DES0011-4540','DES0004-5831','DES0027-4540','DES0032-3706','DES0017-4748','DES0031-4914','DES0006-3249','DES0017+0335','DES0028+0209','DES0008+0001','DES0018-2749','DES0030-6456','DES0019-4457','DES0023-2915','DES0003-0250','DES0019+0001','DES0023-3332','DES0019-0624','DES0017-0124','DES0007-3623','DES0011-0124','DES0001-0458','DES0001-5705','DES0020-2832','DES0003-4706','DES0013-3914','DES0009-2958','DES0017-6122','DES0028-6248','DES0009+0335','DES0017-3123','DES0021-3957','DES0005-5622','DES0004-4831','DES0001-4957','DES0011-0333','DES0000-5914','DES0011-4623','DES0006-0458','DES0031-3040','DES0022-6248','DES0026-2915','DES0029-2958','DES0011-3623','DES0014-0041','DES0022-3457','DES0029-4123','DES0027-6539','DES0025-3957','DES0027-4914','DES0012-4706','DES0009-6248','DES0009-0416','DES0003-5123','DES0022-5914','DES0033-2332','DES0023-2623','DES0007-6205','DES0015+0418','DES0024-5748','DES0016-2915','DES0017+0418','DES0026-4831','DES0019-5248','DES0002+0043','DES0002-4040','DES0029-2415','DES0021-3623','DES0014-3706','DES0020-0333','DES0008+0252','DES0024+0500','DES0018-3623','DES0014-3749','DES0014-4414','DES0004-5248','DES0029-5748','DES0014+0001','DES0032-3749','DES0026-3332','DES0026+0500','DES0002-4331','DES0024-0624','DES0029-4249','DES0021-2541','DES0016-5123','DES0015-4540','DES0020-0416','DES0023-0250','DES0022-0124','DES0025-3832','DES0023-5248','DES0013-2915','DES0012-0458','DES0007-3706','DES0018-0458','DES0002+0209','DES0021-5123','DES0001-5331','DES0022+0209','DES0016-0624','DES0006-4249','DES0009-6039','DES0027-3123','DES0028-0124','DES0023-5457','DES0013-5457','DES0003-0333','DES0023-4914','DES0016-2706','DES0028+0001','DES0028-3749','DES0031-2458','DES0019-5748','DES0029-4748','DES0030-3206','DES0025-0041','DES0012-3415','DES0030-2832','DES0003-3749','DES0025-0207','DES0010-0541','DES0005+0252','DES0019-2706','DES0022-0207','DES0013-6205','DES0006-3957','DES0028-4957','DES0019-4540','DES0003+0335','DES0028-0041','DES0032-3457','DES0012-2958','DES0020-2623','DES0000-5622','DES0022-4331','DES0026-5622','DES0003-6456','DES0008+0209','DES0000-5248','DES0028-3914','DES0017-4206','DES0011-5414','DES0021-5414','DES0024-2541','DES0028-0207','DES0028+0043','DES0000-0416','DES0026+0418','DES0017-5205','DES0028-5248','DES0002-3957','DES0032-3540','DES0011-0207','DES0032-5457','DES0013-4831','DES0023-4957','DES0017-0250','DES0031-5205','DES0009-5248','DES0031+0126','DES0002-4249','DES0032-4040','DES0009+0418','DES0029-0416','DES0008-3540','DES0024-3206','DES0020+0209','DES0023-4457','DES0028-4623','DES0023+0252','DES0022-4831','DES0025-0250','DES0031-0207','DES0028-0707','DES0022-2958','DES0014-3623','DES0029-4206','DES0030-0541','DES0019-2958','DES0008-0250','DES0008-3040','DES0013-4123','DES0032-3832','DES0010-4040','DES0026-5831','DES0011-3540','DES0023+0335','DES0010-4249','DES0014+0209','DES0029-4706','DES0015-0416','DES0024-2749','DES0010-4206','DES0007-3749','DES0031-4457','DES0000+0252','DES0021-6414','DES0001-6414','DES0015-6039','DES0028+0126','DES0013-3206','DES0002-0124','DES0021-3040','DES0025+0126','DES0024-0458','DES0011+0209','DES0008-6414','DES0028-2706','DES0006-4957','DES0005-5331','DES0025-6331','DES0005-3415','DES0005+0209','DES0016-0707','DES0017-3832','DES0032-3914','DES0026-0416','DES0013-5205','DES0007-5957','DES0010-5331','DES0007-5123','DES0013-4040','DES0010-3957','DES0002-5040','DES0025-3457','DES0005+0043','DES0032-3957','DES0000+0209','DES0032-2958','DES0016-3332','DES0026-6205','DES0010-0624','DES0028-2749','DES0009-4831','DES0013-5748','DES0023-6122','DES0025-3040','DES0030-4331','DES0031-0707','DES0008-4748','DES0011-5040','DES0012-5705','DES0019+0126','DES0008-4706','DES0026-3415','DES0033-0624','DES0002-5414','DES0018-3540','DES0008+0043','DES0003-4540','DES0031-6331','DES0025-5331','DES0006-4123','DES0025-2706','DES0002-3332','DES0009-3332','DES0021-6039','DES0001-6205','DES0018-4331','DES0013-0624','DES0032-2706','DES0027-3206','DES0012-4748','DES0005-4914','DES0028+0252','DES0020-4706','DES0016-0041','DES0007-0541','DES0032-4957','DES0010-5622','DES0030-4414','DES0007-4457','DES0025-0124','DES0004-3623','DES0002-4123','DES0026-0458','DES0002-3914','DES0026-3249','DES0009-3249','DES0020-5040','DES0015-3540','DES0032-2415','DES0031-0041','DES0015+0500','DES0004-4748','DES0019-4957','DES0021-4123','DES0006-0416','DES0023-3249','DES0018-0541','DES0006-4206','DES0018-5457','DES0002-4414','DES0022-2706','DES0005-6122','DES0019-5957','DES0008-3457','DES0002-0207','DES0020-3206','DES0027-2832','DES0008-0207','DES0030-0624','DES0017-6456','DES0031-0124','DES0017-4040','DES0017-2832','DES0019-5540','DES0014-0124','DES0017-0416','DES0010-3749','DES0015-0458','DES0013-5957','DES0014+0252','DES0002-0041','DES0031+0335','DES0016-3249','DES0031-5622','DES0006-4331','DES0024-2832','DES0001-3457','DES0031+0001','DES0028-2458','DES0032-0458','DES0017-4123','DES0028-3706','DES0003-3706','DES0031-0250','DES0032-6205','DES0011+0335','DES0023-0333','DES0033-3249','DES0032-2623','DES0032+0418','DES0022+0043','DES0001-0624','DES0025-4249','DES0017-3914','DES0022+0126','DES0029-3415','DES0006-4040','DES0028-3040','DES0018-4914','DES0000-4831','DES0004-3457','DES0010-4414','DES0014-6414','DES0013-3957','DES0026-5414','DES0031-2249','DES0011-4457','DES0019-0124','DES0025-3749','DES0014-5248','DES0011+0126','DES0022+0001','DES0025-4206','DES0016-5414','DES0027-4457','DES0004-5540','DES0010-3914','DES0012-6331','DES0027-0541','DES0025-4123','DES0031-0333','DES0024-5540','DES0024-4623','DES0004-3540','DES0002+0001','DES0030-5123','DES0025-3914','DES0011-3040','DES0015-3457','DES0027-6414','DES0000-3623','DES0020+0418','DES0006-3332','DES0019-3415','DES0025-2458','DES0015-5331','DES0003+0252','DES0003-0416','DES0031-2749','DES0029-2915','DES0020-4623','DES0011+0001','DES0029-6122','DES0021-4748','DES0033-0541','DES0026-2623','DES0021-4206','DES0033-2915','DES0018-3706','DES0017-0207','DES0005+0126','DES0026-5123','DES0005-0207','DES0015-5622','DES0019-0041','DES0006-5414','DES0014+0043','DES0015-5040','DES0004-0541','DES0014-2832','DES0029-3457','DES0028-3957','DES0006-5705','DES0031-4540','DES0009-0333','DES0007-4623','DES0002+0126','DES0026-0333','DES0003-5748','DES0031-5831','DES0005-0250','DES0025-3540','DES0021-0458','DES0026-4414','DES0001-0541','DES0015-3415','DES0006-3914','DES0006-5914','DES0015-0541','DES0005-0707','DES0020-3249','DES0000+0418','DES0029-0333','DES0011+0252','DES0005+0001','DES0028-3623','DES0026-4331','DES0007-3123','DES0003-5457','DES0028-4040','DES0014-0333','DES0006-4414','DES0027-5205','DES0032-2206','DES0018-3457','DES0001-4914','DES0029+0500','DES0003-6039','DES0021-3706','DES0003-3832','DES0022-0041','DES0020-0207','DES0022-3540','DES0021-4040','DES0024-5957','DES0025-2958','DES0027-6039','DES0025-3623','DES0031+0043','DES0005-6331','DES0011-5914','DES0020-0250','DES0025+0209','DES0008-5748','DES0020+0252','DES0018-4249','DES0016-4623','DES0005-0124','DES0028-3832','DES0018-6331','DES0025+0043','DES0029-5540','DES0012-0416','DES0000+0335','DES0000-0250','DES0029-5040','DES0011+0043','DES0012-5123','DES0002-4206','DES0019+0043','DES0015-5831','DES0021-3749','DES0006+0418','DES0011-0041','DES0010-3706','DES0017-4831','DES0006-5040','DES0024-6456','DES0021-3914','DES0000-0333','DES0016+0001','DES0015-4457','DES0019-6205','DES0003-5205','DES0014+0126','DES0033-2832','DES0020-2915','DES0023-4540','DES0022-4249','DES0003-6248','DES0022-3415','DES0030-5957','DES0000-0207','DES0015-2958','DES0017-3957','DES0014-4331','DES0031-3123','DES0026-2415','DES0012+0418','DES0000-3706','DES0014-3832','DES0009-5831','DES0031+0252','DES0030-4831','DES0021-2749','DES0025-4040','DES0026+0335','DES0029-2623','DES0002-5957','DES0014+0335','DES0022-5705','DES0032-4623','DES0022-5205','DES0029-3540','DES0019-3332','DES0029-0458','DES0009-0458','DES0033-2541','DES0003-4623','DES0003-4457','DES0006+0335','DES0011-0250','DES0017-5705','DES0032-0416','DES0006-0333','DES0018+0500','DES0025+0001','DES0025+0252','DES0011-3457','DES0028-5914','DES0018-3040','DES0014-0207','DES0031-5414','DES0027-0624','DES0012+0500','DES0014-0250','DES0009-5540','DES0015-3040','DES0010-4123','DES0028-0250','DES0009+0500','DES0007-4540','DES0008-0041','DES0025-3706','DES0017-3749','DES0008-5205','DES0000-4748','DES0008-3415','DES0023-0416','DES0007-3206','DES0003-0458','DES0021-0541','DES0016-6248','DES0032-3623','DES0006+0500','DES0003+0500','DES0010-3832','DES0020+0335','DES0002-3415','DES0017-5914','DES0012-3332','DES0003-3249','DES0013-3249','DES0009-4914','DES0031+0209','DES0010-4957','DES0006-3832','DES0000-3540','DES0022-0624','DES0024-0541','DES0008-0124','DES0027-2541','DES0004-0624','DES0030-2541','DES0029+0335','DES0010-4331','DES0022-4414','DES0014-5540','DES0014-4206','DES0029-5331','DES0032+0500','DES0029+0418','DES0020-5331','DES0021+0500','DES0025-4748','DES0011-6122','DES0011-3123','DES0017+0252','DES0017-3206','DES0020-5831','DES0027-2332','DES0010-3206','DES0010-6456']



######################################################################
#                       measure_moments_targets
######################################################################

target_noise_tiers:
    gold_id: '/global/cfs/cdirs/des/BFD_Y6/gold_id.npy' # it could be None
    star_galaxy_separation_value: 10 # Mr/Mf < star_galaxy_separation
    flux_covariance_maps_nside: 4096 # 
    overwrite_noisetiers: False
    sn_min: 7
    sn_max: 200
    noiseStep: .3
    psfStep: .3
    
    
